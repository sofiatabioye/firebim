(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1320:function(e,t,a){"use strict";a.r(t);var r=a(912),q=a.n(r),r=a(41),B=a.n(r),r=a(900),A=a.n(r),r=a(913),M=a.n(r),T=a(1),L=a.n(T),K=a(230),r=a(902),R=a.n(r),U=a(894),_=a(896),z=a(1191),J=a(1192),r=a(1306),H=a.n(r),Y=a(919),Q=a(46);a(1308);function n(t,e){var a,r=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)),r}function W(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(Object(a),!0).forEach(function(e){B()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var X={title:{presence:{allowEmpty:!1,message:"is required"},length:{maximum:32}},description:{presence:{allowEmpty:!1,message:"is required"},length:{maximum:32}}};t.default=function(){var e=Object(T.useState)(!1),t=A()(e,2),a=t[0],r=t[1],n=Object(T.useState)(!1),l=A()(n,2),c=(l[0],l[1],Object(T.useState)({})),o=A()(c,2),s=o[0],i=o[1],u=Object(T.useState)(!1),e=A()(u,2),m=e[0],d=e[1],t=Object(T.useState)(!1),n=A()(t,2),l=n[0],p=n[1],c=Object(T.useState)(!1),o=A()(c,2),u=o[0],E=o[1],e=Object(T.useState)(null),t=A()(e,2),j=t[0],b=t[1],n=Object(T.useState)("add"),c=A()(n,2),f=c[0],h=c[1],o=Object(T.useState)(!1),e=A()(o,2),v=e[0],g=e[1],t=Object(T.useState)(!1),n=A()(t,2),c=n[0],x=(n[1],Object(K.b)()),o=Object(T.useState)(void 0),e=A()(o,2),y=e[0],O=e[1],t=Object(T.useState)({isValid:!1,values:{},touched:{},errors:{}}),n=A()(t,2),w=n[0],I=n[1];Object(T.useEffect)(function(){var t=R()(w.values,X);I(function(e){return W(W({},e),{},{isValid:!t,errors:t||{}})}),v&&(x(Object(Y.e)()),g(!1))},[w.values,v]);function N(e){return e.split(",").map(function(t){var e=V.find(function(e){return e.id===parseInt(t)});return e?e.name:null}).toString()}function C(e){return!(!w.touched[e]||!w.errors[e])}function k(a){a.persist(),I(function(e){var t;return W(W({},e),{},{values:W(W({},e.values),{},(t={},B()(t,a.target.name,"checkbox"===a.target.type?a.target.checked:a.target.value),B()(t,a.target.name,"file"===a.target.type?O(a.target.files[0]):a.target.value),t)),touched:W(W({},e.touched),{},B()({},a.target.name,!0))})})}function P(e){d(!m),i(e)}function S(e){r(!0),i(e),b(e.purposeGroup?e.purposeGroup.split(",").map(function(t){return V.find(function(e){return e.id===parseInt(t)})}):{}),h("edit"),I({isValid:!0,values:e,touched:{},errors:{}})}function D(){r(!1),i({}),h("add"),b(null),I({isValid:!1,values:{},touched:{},errors:{}})}function G(e){b({selected:e})}var F,V=[{name:"1(a) Flat",id:1,category:"Residential (Dwellings)"},{name:"1(b) Terraced Building",id:2,category:"Residential (Dwellings)"},{name:"1(c) Semi-Detached",id:3,category:"Residential (Dwellings)"},{name:"2(a) Office Building",id:4,category:"Residential (Institutional)"}],o=function(){var t=q()(M.a.mark(function e(t){var a;return M.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),w.isValid&&j)return a=j.selected.map(function(e){return e.id}).join(","),a=W(W({},w.values),{purposeGroup:a}),e.next=6,x(Object(Y.a)(a));e.next=9;break;case 6:I({isValid:!1,values:{},touched:{},errors:{}}),r(!1),g(!0);case 9:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),e=function(){var t=q()(M.a.mark(function e(t){var a;return M.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),w.isValid&&j)return a=null===(a=j.selected)||void 0===a?void 0:a.map(function(e){return e.id}).join(","),a=W(W({},w.values),{purposeGroup:a}),e.next=6,x(Object(Y.g)(s._id,a));e.next=7;break;case 6:b(null);case 7:I({isValid:!1,values:{},touched:{},errors:{}}),b(null),r(!1),g(!0);case 11:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),t=function(){var e=q()(M.a.mark(function e(){return M.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s._id)return e.next=3,x(Object(Y.b)(s._id));e.next=7;break;case 3:return e.next=5,i({});case 5:return e.next=7,x(Object(Y.e)());case 7:E(!1);case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),n=Object(K.c)(function(e){return e.project.projects});return L.a.createElement(L.a.Fragment,null,L.a.createElement(U.T,null,L.a.createElement(U.j,{xs:"12",xl:"12",className:"my-4 border-bottom mb-5"},L.a.createElement(U.e,{className:"float-right sidebar-dark",color:"primary",size:"md",onClick:function(){return r(!0)}},"Add New Project"),L.a.createElement("h1",null,"Projects"))),L.a.createElement(U.T,null,n&&0<n.length?L.a.createElement(U.m,{items:n,fields:["projectTitle","purposeGroup","address","actions"],itemsPerPage:10,pagination:!0,tableFilter:!0,sorter:!0,hover:!0,scopedSlots:{projectTitle:function(e){return L.a.createElement("td",null,e.thumbnail?L.a.createElement(U.B,{src:"data:image/png;base64, "+e.thumbnail,align:"left",fluid:!0,height:50,width:50,className:"border block mr-2"}):null,L.a.createElement(Q.b,{to:"/viewer/"+e.viewerurn},L.a.createElement(U.I,{className:"mt-2 block font-bold"},e.title)))},purposeGroup:function(e){return L.a.createElement("td",null,N(e.purposeGroup))},actions:function(t){return L.a.createElement("td",{className:"px-4"},L.a.createElement(U.e,{className:"",color:"info",variant:"ghost",onClick:function(){return e=t,r(!1),E(!1),d(!1),p(!0),void i(e);var e}},L.a.createElement(_.a,{name:"cil-description",color:"info",customClasses:"c-sidebar-nav-icon"})),L.a.createElement(U.e,{className:"",color:"primary",variant:"ghost",onClick:function(){return S(t)}},L.a.createElement(_.a,{name:"cil-pencil",color:"primary",customClasses:"c-sidebar-nav-icon"})),L.a.createElement(U.e,{className:"",color:"info",variant:"ghost",onClick:function(){return P(t)}},L.a.createElement(z.a,{icon:J.b})," ",t.modelStorageId?"Update Model":"Upload Model"),L.a.createElement(U.e,{className:"pr-3",color:"danger",variant:"ghost",onClick:function(){return e=t,r(!1),E(!0),void i(e);var e}},L.a.createElement(_.a,{name:"cil-trash",customClasses:"c-sidebar-nav-icon"})))}}}):L.a.createElement(U.db,null),L.a.createElement(U.K,{show:a,onClose:D},L.a.createElement(U.N,{closeButton:!0},L.a.createElement(U.O,null,"edit"===f?"Edit "+s.title+" Project":"Create New FireBIM Project")),L.a.createElement(U.L,null,(F="add"===f?o:e,L.a.createElement(U.t,{className:"form-horizontal",onSubmit:F},L.a.createElement(U.u,{row:!0},L.a.createElement(U.j,{md:"3"},L.a.createElement(U.I,{htmlFor:"hf-email"},"Project Name")),L.a.createElement(U.j,{xs:"12",md:"9"},L.a.createElement(U.C,{type:"text",id:"title",name:"title",placeholder:"Enter Project Name",onChange:k,value:w.values.title||"",required:!0}),L.a.createElement(U.jb,null,"Looks good! "),L.a.createElement(U.H,null," Please enter valid title "),L.a.createElement(U.v,{className:"help-block"}," ",C("title")?w.errors.title[0]:null," ")),L.a.createElement(U.j,{md:"3"},L.a.createElement(U.I,{htmlFor:"projectId"},"Project ID")),L.a.createElement(U.j,{xs:"12",md:"9"},L.a.createElement(U.C,{type:"text",id:"projectId",name:"projectId",placeholder:"Project ID",onChange:k,value:w.values.projectId||"",required:!0}),L.a.createElement(U.v,{className:"help-block"},C("projectId")?w.errors.projectId[0]:null)),L.a.createElement(U.j,{xs:"12",className:"my-3 border-top"}),L.a.createElement(U.j,{xs:"12"},L.a.createElement(U.I,{className:"uppercase font-bold py-2",color:"primary"},"Project details")),L.a.createElement(U.j,{md:"3"},L.a.createElement(U.I,{htmlFor:"description"},"Description of proposed works")),L.a.createElement(U.j,{xs:"12",md:"9"},L.a.createElement(U.C,{type:"text",id:"description",name:"description",placeholder:"Project description",onChange:k,value:w.values.description||"",required:!0}),L.a.createElement(U.v,{className:"help-block"},C("description")?w.errors.description[0]:null)),L.a.createElement(U.j,{md:"3"},L.a.createElement(U.I,{htmlFor:"address"},"Project Address")),L.a.createElement(U.j,{xs:"12",md:"9"},L.a.createElement(U.C,{type:"text",id:"address",name:"address",placeholder:"Project address",onChange:k,value:w.values.address||"",required:!0}),L.a.createElement(U.v,{className:"help-block"},C("address")?w.errors.address[0]:null)),L.a.createElement(U.j,{md:"3"},L.a.createElement(U.I,{htmlFor:"client"},"Client")),L.a.createElement(U.j,{xs:"12",md:"9"},L.a.createElement(U.C,{type:"text",id:"client",name:"client",placeholder:"Client",onChange:k,value:w.values.client||"",required:!0}),L.a.createElement(U.v,{className:"help-block"},C("client")?w.errors.client[0]:null)),L.a.createElement(U.j,{md:"3"},L.a.createElement(U.I,{htmlFor:"client"},"Agent")),L.a.createElement(U.j,{xs:"12",md:"9"},L.a.createElement(U.C,{type:"text",id:"agent",name:"agent",placeholder:"Agent",onChange:k,value:w.values.agent||"",required:!0}),L.a.createElement(U.v,{className:"help-block"},C("agent")?w.errors.agent[0]:null)),L.a.createElement(U.j,{xs:"12",className:"my-3 border-top"}),L.a.createElement(U.j,{md:"3",className:"mt-3"},L.a.createElement(U.I,{htmlFor:"purposeGroup",className:"uppercase font-bold"},"Purpose Group")),L.a.createElement(U.j,{xs:"12",md:"9",className:"mt-3"},L.a.createElement(H.a,{options:V,selectedValues:j,onSelect:G,showCheckbox:!0,groupBy:"category",placeholder:"Select purpose group",displayValue:"name",id:"purposeGroup",name:"purposeGroup",required:!0}),L.a.createElement(U.v,{className:"help-block"},C("purposeGroup")?w.errors.purposeGroup[0]:null))),L.a.createElement(U.M,null,L.a.createElement(U.e,{className:"text-white sidebar-dark",type:"submit"},"Submit")," ",L.a.createElement(U.e,{color:"secondary",onClick:function(){return"edit"===f?D():r(!1)}},"Cancel")))))),L.a.createElement(U.K,{show:u,onClose:E,alignment:"center"},L.a.createElement(U.N,null,L.a.createElement(U.O,null,"Delete ",s.title)),L.a.createElement(U.L,null,"Are you sure you want to delete this project?"),L.a.createElement(U.M,null,L.a.createElement(U.e,{color:"danger",onClick:t},"Yes"),L.a.createElement(U.e,{color:"primary",onClick:function(){return E(!1)}},"No"))),L.a.createElement(U.K,{show:m,onClose:P},L.a.createElement(U.N,{closeButton:!0}," Upload Model"),L.a.createElement(U.t,{onSubmit:function(e){e.preventDefault();e=new FormData;e.append("model",y),e.append("projectId",s._id),x(Object(Y.h)(e)),I({isValid:!1,values:{},touched:{},errors:{}}),g(!0)}},L.a.createElement(U.L,null,L.a.createElement(U.u,null,L.a.createElement("input",{type:"file",name:"model",id:"model",accept:".rvt",onChange:k,required:!0})),c?L.a.createElement("div",{className:"float-left"},L.a.createElement(U.db,{size:"sm"})," Uploading..."):null),L.a.createElement(U.M,null,L.a.createElement(U.e,{className:"text-white bg-info",type:"submit"},"Submit")," ",L.a.createElement(U.e,{color:"secondary",onClick:function(){return d(!1)}},"Cancel")))),L.a.createElement(U.K,{show:l,onClose:p},L.a.createElement(U.N,{closeButton:!0},L.a.createElement(U.O,null,null==s?void 0:s.title," Project")),L.a.createElement(U.L,null,L.a.createElement(U.T,null,L.a.createElement(U.j,{xs:"12",md:"4"},L.a.createElement(U.I,null,L.a.createElement("b",null,"Project ID"))),L.a.createElement(U.j,{xs:"12",md:"8"},L.a.createElement(U.I,null,s.projectId)),L.a.createElement(U.j,{xs:"12",className:"my-3 border-top"}),L.a.createElement(U.j,{xs:"12",md:"4"},L.a.createElement(U.I,null,L.a.createElement("b",null,"Project Description"))),L.a.createElement(U.j,{xs:"12",md:"8"},L.a.createElement(U.I,null,s.description)),L.a.createElement(U.j,{xs:"12",md:"4"},L.a.createElement(U.I,null,L.a.createElement("b",null,"Project Address"))),L.a.createElement(U.j,{xs:"12",md:"8"},L.a.createElement(U.I,null,s.address)),L.a.createElement(U.j,{xs:"12",md:"4"},L.a.createElement(U.I,null,L.a.createElement("b",null,"Project Client"))),L.a.createElement(U.j,{xs:"12",md:"8"},L.a.createElement(U.I,null,s.client)),L.a.createElement(U.j,{xs:"12",md:"4"},L.a.createElement(U.I,null,L.a.createElement("b",null,"Project Agent"))),L.a.createElement(U.j,{xs:"12",md:"8"},L.a.createElement(U.I,null,s.agent)),L.a.createElement(U.j,{xs:"12",className:"my-3 border-top"}),L.a.createElement(U.j,{xs:"12",md:"4"},L.a.createElement(U.I,null,L.a.createElement("b",null,"Project Purpose Group"))),L.a.createElement(U.j,{xs:"12",md:"8"},L.a.createElement(U.I,null,s.purposeGroup?N(s.purposeGroup):"")))))))}}}]);